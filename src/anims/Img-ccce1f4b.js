import{x as R,S as j,T as z,U as O,W as T,X as m,h as l,Y as L,B as A,i as B,Z as $,_ as C,v as U,p as w,s as f,u as x,R as F,$ as V,a0 as W,a1 as q,a2 as N}from"./makeScene2D-136b8eb1.js";function H(a){if(!_()||a.startsWith("/cors-proxy/"))return a;const t=new URL(window.location.toString());try{const e=new URL(a,t);if(!e.protocol.startsWith("http")||t.host===e.host||!X(e.host))return a}catch{return a}return`/cors-proxy/${encodeURIComponent(a)}`}function X(a){const t=Y();if(t.length===0)return!0;for(const e of t)if(e.toLowerCase().trim()===a)return!0;return!1}function _(){return!1}let y;function Y(){return{}.VITEST!=="true"&&y?[...y]:(y=function(){if(!_()||!{VITE_MC_PROXY_ENABLED:"false",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1})return[];const t={}.VITE_MC_PROXY_ALLOW_LIST??"[]",e=JSON.parse(t);Array.isArray(e)||R().error("Parsed Allow List expected to be an Array, but is "+typeof e);const i=[];for(const s of e){if(typeof s!="string"){R().warn("Unexpected Value in Allow List: "+s+". Expected a String. Skipping.");continue}i.push(s)}return i}(),[...y])}j(J,O());function*J(...a){for(const t of a)yield t;yield*z(!1,...a)}var k=globalThis&&globalThis.__decorate||function(a,t,e,i){var s=arguments.length,n=s<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(a,t,e,i);else for(var o=a.length-1;o>=0;o--)(r=a[o])&&(n=(s<3?r(n):s>3?r(t,e,n):r(t,e))||n);return s>3&&n&&Object.defineProperty(t,e,n),n};class u extends T{constructor(t,e,i,s,n,r){super(),this.startPoint=t,this.radius=e,this.xAxisRotationDegree=i,this.largeArcFlag=s,this.sweepFlag=n,this.endPoint=r,this.xAxisRotation=this.xAxisRotationDegree*m,this.radius=new l(Math.abs(e.x),Math.abs(e.y));const o=t.sub(r).div(2).transform(L.fromRotation(-i).domMatrix),c=o.x*o.x/(e.x*e.x)+o.y*o.y/(e.y*e.y);if(c>1){const I=Math.sqrt(c);e.x=I*e.x,e.y=I*e.y}const p=new l(e.ctg*o.y,e.perpendicular.ctg*o.x).scale(Math.sqrt(1/(o.x*o.x/(e.x*e.x)+o.y*o.y/(e.y*e.y))-1)*(s===n?-1:1));this.xAxisRotationMatrix=L.fromRotation(i).domMatrix,this.center=p.transform(this.xAxisRotationMatrix).add(t.add(r).div(2));const g=o.sub(p).div(e),D=o.scale(-1).sub(p).div(e);this.startAngle=g.radians,this.deltaAngle=l.angleBetween(g,D)%(Math.PI*2),this.sweepFlag===0&&this.deltaAngle>0&&(this.deltaAngle-=Math.PI*2),this.sweepFlag===1&&this.deltaAngle<0&&(this.deltaAngle+=Math.PI*2),u.el.setAttribute("d",`M ${this.startPoint.x} ${this.startPoint.y} A ${this.radius.x} ${this.radius.y} ${this.xAxisRotationDegree} ${this.largeArcFlag} ${this.sweepFlag} ${this.endPoint.x} ${this.endPoint.y}`),this.length=u.el.getTotalLength();const M=new A(u.el.getBBox());this.points=[M.topLeft,M.bottomRight]}getAnglePosition(t){return this.radius.mul(l.fromRadians(t)).transform(this.xAxisRotationMatrix).add(this.center)}getAngleDerivative(t){return new l(-this.radius.x*Math.sin(t),this.radius.y*Math.cos(t)).transform(this.xAxisRotationMatrix)}draw(t,e,i,s){const n=this.startAngle+this.deltaAngle*e,r=this.startAngle+this.deltaAngle*i,o=this.getPoint(e),c=this.getPoint(i);return s&&t.moveTo(o.position.x,o.position.y),t.ellipse(this.center.x,this.center.y,this.radius.x,this.radius.y,this.xAxisRotation,n,r,this.sweepFlag===0),[o,c]}getPoint(t){const e=this.startAngle+t*this.deltaAngle,i=this.getAngleDerivative(e).normalized;return{position:t===0?this.startPoint:t===1?this.endPoint:this.getAnglePosition(e),tangent:i,normal:i.perpendicular}}get arcLength(){return this.length}}k([B(()=>{const a=document.createElementNS("http://www.w3.org/2000/svg","svg"),t=document.createElementNS("http://www.w3.org/2000/svg","path");return a.appendChild(t),$.shadowRoot.appendChild(a),t})],u,"el",void 0);function G(a,t,e,i,s=!1){const n={arcLength:0,minSin:1,segments:[]};if(e<t){const g=Math.floor((t-e)/(Math.PI*2))+1;e+=Math.PI*2*g}else if(e>t+Math.PI*2){const g=Math.floor((e-t)/(Math.PI*2));e-=Math.PI*2*g}const r=(t+e)/2,o=a.mul(l.fromRadians(t)),c=a.mul(l.fromRadians(e)),p=a.mul(l.fromRadians(r)).scale(s?-1:1);return i&&b(n,new C(l.zero,o)),E(n,a,o,p,t,r,s),E(n,a,p,c,r,e,s),i&&b(n,new C(c,l.zero)),n}function b(a,t){a.segments.push(t),a.arcLength+=t.arcLength}function E(a,t,e,i,s,n,r){const o=Math.abs(s-n)<=180?1:0,c=s>n?0:1,p=r?0:1;b(a,new u(e,t,0,0,o^p^c,i))}var v=globalThis&&globalThis.__decorate||function(a,t,e,i){var s=arguments.length,n=s<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(a,t,e,i);else for(var o=a.length-1;o>=0;o--)(r=a[o])&&(n=(s<3?r(n):s>3?r(t,e,n):r(t,e))||n);return s>3&&n&&Object.defineProperty(t,e,n),n};class P extends U{constructor(t){super(t)}profile(){return G(this.size().scale(.5),this.startAngle()*m,this.endAngle()*m,this.closed(),this.counterclockwise())}desiredSize(){return{x:this.width.context.getter(),y:this.height.context.getter()}}offsetComputedLayout(t){return t}childrenBBox(){return A.fromSizeCentered(this.computedSize())}getPath(){return this.requiresProfile()?this.curveDrawingInfo().path:this.createPath()}getRipplePath(){return this.createPath(this.rippleSize())}getCacheBBox(){return super.getCacheBBox().expand(this.rippleSize())}createPath(t=0){const e=new Path2D,i=this.startAngle()*m;let s=this.endAngle()*m;const n=this.size().scale(.5).add(t),r=this.closed();if(s>i+Math.PI*2){const o=Math.floor((s-i)/(Math.PI*2));s-=Math.PI*2*o}return r&&e.moveTo(0,0),e.ellipse(0,0,n.x,n.y,0,i,s,this.counterclockwise()),r&&e.closePath(),e}}v([w(0),f()],P.prototype,"startAngle",void 0);v([w(360),f()],P.prototype,"endAngle",void 0);v([w(!1),f()],P.prototype,"counterclockwise",void 0);v([x()],P.prototype,"profile",null);var d=globalThis&&globalThis.__decorate||function(a,t,e,i){var s=arguments.length,n=s<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,r;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(a,t,e,i);else for(var o=a.length-1;o>=0;o--)(r=a[o])&&(n=(s<3?r(n):s>3?r(t,e,n):r(t,e))||n);return s>3&&n&&Object.defineProperty(t,e,n),n},S;class h extends F{constructor(t){super(t),"src"in t||R().warn({message:"No source specified for the image",remarks:`<p>The image won&#39;t be visible unless you specify a source:</p>
<pre><code class="language-tsx"><span class="hljs-keyword">import</span> myImage <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;./example.png&#x27;</span>;
<span class="hljs-comment">// ...</span>
<span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{myImage}</span> /&gt;</span></span>;
</code></pre><p>If you did this intentionally, and don&#39;t want to see this warning, set the <code>src</code>
property to <code>null</code>:</p>
<pre><code class="language-tsx">&lt;<span class="hljs-title class_">Img</span> src={<span class="hljs-literal">null</span>} /&gt;
</code></pre><p><a href='https://motioncanvas.io/docs/media#images' target='_blank'>Learn more</a> about working with
images.</p>
`,inspect:this.key})}desiredSize(){const t=super.desiredSize();if(t.x===null&&t.y===null){const e=this.image();return{x:e.naturalWidth,y:e.naturalHeight}}return t}image(){const t=this.src();let e="",i="";if(t){i=H(t);const n=new URL(i,window.location.origin);if(n.origin===window.location.origin){const r=this.view().assetHash();n.searchParams.set("asset-hash",r)}e=n.toString()}let s=S.pool[i];return s||(s=document.createElement("img"),s.crossOrigin="anonymous",s.src=e,S.pool[i]=s),s.complete||V.collectPromise(new Promise((n,r)=>{s.addEventListener("load",n),s.addEventListener("error",()=>r(new W({message:"Failed to load an image",remarks:`The <code>src</code> property was set to:
<pre><code>${t}</code></pre>
...which resolved to the following url:
<pre><code>${e}</code></pre>
Make sure that source is correct and that the image exists.<br/>
<a target='_blank' href='https://motioncanvas.io/docs/media#images'>Learn more</a>
about working with images.`,inspect:this.key})))})),s}imageCanvas(){const t=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});if(!t)throw new Error("Could not create an image canvas");return t}filledImageCanvas(){const t=this.imageCanvas(),e=this.image();return t.canvas.width=e.naturalWidth,t.canvas.height=e.naturalHeight,t.imageSmoothingEnabled=this.smoothing(),t.drawImage(e,0,0),t}draw(t){this.drawShape(t);const e=this.alpha();if(e>0){const i=A.fromSizeCentered(this.computedSize());t.save(),t.clip(this.getPath()),e<1&&(t.globalAlpha*=e),t.imageSmoothingEnabled=this.smoothing(),q(t,this.image(),i),t.restore()}this.clip()&&t.clip(this.getPath()),this.drawChildren(t)}applyFlex(){super.applyFlex();const t=this.image();this.element.style.aspectRatio=(this.ratio()??t.naturalWidth/t.naturalHeight).toString()}getColorAtPoint(t){const e=this.computedSize(),i=this.naturalSize(),s=new l(t).add(this.computedSize().scale(.5)).mul(i.div(e).safe);return this.getPixelColor(s)}naturalSize(){const t=this.image();return new l(t.naturalWidth,t.naturalHeight)}getPixelColor(t){const e=this.filledImageCanvas(),i=new l(t),s=e.getImageData(i.x,i.y,1,1).data;return new N({r:s[0],g:s[1],b:s[2],a:s[3]/255})}collectAsyncResources(){super.collectAsyncResources(),this.image()}}S=h;h.pool={};d([f()],h.prototype,"src",void 0);d([w(1),f()],h.prototype,"alpha",void 0);d([w(!0),f()],h.prototype,"smoothing",void 0);d([x()],h.prototype,"image",null);d([x()],h.prototype,"imageCanvas",null);d([x()],h.prototype,"filledImageCanvas",null);d([x()],h.prototype,"naturalSize",null);export{P as C,h as I,J as a};
